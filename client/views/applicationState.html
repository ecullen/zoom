<section>

<div id="application_state_page" class="container-fluid">

    <!-- Big Modal -->
    <div id = "graphiteModal" class="modal big-modal-class" 
         tabindex="-1" 
         role="dialog" 
         aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div id="graphiteBody" class="modal-body big-modal-body">
                </div>
            </div>
        </div>
    </div>

<div id="opdepModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"
        data-bind="with:appStateModel">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" data-bind="style: {backgroundColor: environment.envColor, color: environment.envTextColor}">
                    <h2>
                        Please double check!
                        <br>These will be the affected services.
                    </h2>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered" id="opdepTable">
                        <tr>
                            <td>Application Name </td>
                            <td>Hostname </td>
                            <td  style="width:50px"></td>
                        </tr>
                        <tbody data-bind="foreach: opdepAppStateArray">
                            <tr>
                                <td data-bind="text: $data.componentId"></td>
                                <td data-bind="text: $data.applicationHost"></td>
                                <td><input type="button" class="btn btn-default" value="Remove from list" data-bind="click: $parent.removeFromOpdepAppStateArray"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <form class="container-fluid">
                        <div class="row" >
                            <div >
                                <button type="button" class="btn btn-default" data-dismiss="modal"> Cancel </button>
                                <button type="button" class="btn btn-danger"
                                    data-bind="click: submitOpdepAction, text:buttonLabel"></button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="groupCheckModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"
        data-bind="with:appStateModel">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" data-bind="style: {backgroundColor: environment.envColor, color: environment.envTextColor}">
                    <h2 data-bind="text: environment.env"></h2>
                    <h4>Please re-enter your domain password to proceed.</h4>
                </div>
                <div class="modal-body">
                    <table class="table table-bordered">
                        <tr>
                            <td>Application Name </td>
                            <td>Hostname </td>
                            <td style="width:50px"></td>
                        </tr>
                        <tbody data-bind="foreach: groupControl, visible: groupMode()">
                            <tr>
                                <td data-bind="text: $parent.parseAppName(configurationPath)"></td>
                                <td data-bind="text: applicationHost"></td>
                                <td><input type="button" class="btn btn-default" value="Remove from list" data-bind="click: $parent.removeFromGroupControl"></td>
                            </tr>
                        </tbody>
                        <tbody data-bind="visible: !groupMode()">
                            <tr>
                                <td data-bind="text: parseAppName(clickedApp().configurationPath)"></td>
                                <td data-bind="text: clickedApp().applicationHost"></td>
                                <td><input type="button" class="btn btn-default" value="Remove from list" data-bind="click: removeFromClickedApp"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <form class="container-fluid">
                        <div class="row" >
                            <div class="col-md-6" >
                                <label class="sr-only" for="passwordFieldG">Password</label>
                                <input type="password" id="passwordFieldG" class="form-control" name="password" placeholder="Password"
                                    data-bind="value: passwordConfirm, valueUpdate: 'afterkeydown', event: {keypress: checkEnter}"
                                    rel="popover" data-content="Incorrect Password" data-placement="bottom"/>
                            </div>
                            <div >
                                <button type="button" class="btn btn-default" data-dismiss="modal"> Cancel </button>
                                <button type="button" class="btn btn-danger" id="Gsend" 
                                    data-bind="click: submitAction, text:buttonLabel"></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="accordion" id="advancedOptions">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" data-toggle="collapse" href="#advancedOptionsBody" data-bind="visible: showAdvancedOptions">
                                <p align="left" style="margin-left: 25px">Advanced Options</p>
                            </a>
                        </div>
                        <div id="advancedOptionsBody" class="accordion-body collapse in" >
                            <div class="accordion-inner">
                                <input type="checkbox" style="margin-left: 25px;width:20px;height:20px" data-bind="checked: forceRestartEnabled, visible: showRestartOptions"
                                   title="Valid for Restart command only">
                                    <label data-bind="visible: showRestartOptions" style="margin-left: 5px">
                                        <span>Restart without dependencies.</span>
                                    </label>
                                </input>
                                <p style="margin-left: 55px; margin-right:55px;" data-bind="visible: showRestartOptions">
                                    This will restart only the selected application(s) regardless of whether the startup dependencies for that application are up or not.
                                    Most often you probably don’t need to use this option.
                                </p>
                                <input type="checkbox" style="margin-left: 25px;width:20px;height:20px" data-bind="checked: opdepRestartEnabled, visible: showRestartOptions"
                                   title="Valid for Restart command only">
                                    <label data-bind="visible: showRestartOptions" style="margin-left: 5px">
                                        <span>Restart with all the downstream operational dependencies.</span>
                                    </label>
                                </input>
                                <p style="margin-left: 55px; margin-right:55px;" data-bind="visible: showRestartOptions">
                                    1. Restart the selected application(s)
                                    </br>2. Then (re)start the applications that have operational dependencies on the applications in step 1
                                    </br>3. Then (re)start the applications that have operational dependencies on the applications in step 2
                                    </br>4. And so on until all layers of operational dependencies have been started
                                </p>
                                <input type="checkbox" style="margin-left: 25px;width:20px;height:20px" data-bind="checked: opdepStopEnabled, visible: showStopOptions"
                                   title="Valid for Restart command only">
                                    <label data-bind="visible: showStopOptions" style="margin-left: 5px">
                                        <span>Stop all downstream operational dependencies.</span>
                                    </label>
                                </input>
                                <p style="margin-left: 55px; margin-right:55px;" data-bind="visible: showStopOptions">
                                    1. Stop the selected application(s)
                                    </br>2. Then stop the applications that have operational dependencies on the applications in step 1
                                    </br>3. Then stop the applications that have operational dependencies on the applications in step 2
                                    </br>4. And so on until all layers of operational dependencies have been stopped
                                </p>
                            </div>
                        </div>
                </div>
            </div>
        </div>
    </div>

    <div class="page-header">
        <h3 style="color: gray">
            <span data-bind="text: appStateModel.applicationStateArray().length"></span> total services
            <span class="pull-right">
                Zookeeper startup is :
                <div class="btn-group" data-bind="visible: login.elements.authenticated">
                    <button type="button" data-bind="click: function(){mode.setGlobalMode('auto')},
                                                     attr: {class: mode.OnClass()}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Set Zookeeper to react to state changes.">On</button>
                    <button type="button" data-bind="click: function(){mode.setGlobalMode('manual')}, attr: {class: mode.OffClass()}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Set Zookeeper to ignore state changes.">Off</button>
                </div>
                <span data-bind="visible: !login.elements.authenticated(), text: mode.isOn() ? 'On' : 'Off'"/>
                <span data-bind="text: mode.timingString, visible: mode.isOn()"/>
            </span>
        </h3>

        <!-- Diff Mode/ Reload Server Cache -->
        <div class="row view-tabs">
            <div class="pull-right">
                Diff Mode :
                <div class="btn-group">
                    <button type="button"
                            data-bind="click: function(){appStateModel.customFilters.enableTimeFilter()},
                                       attr: {class: ('btn btn-default' + (appStateModel.customFilters.filterByTime() ? ' active' : '')),
                                              title: appStateModel.customFilters.timeToolTip}"
                            data-toggle="tooltip"
                            data-placement="top"> Update

                        <span class="glyphicon glyphicon-refresh" data-bind="visible: appStateModel.customFilters.filterByTime()"> </span>
                    </button>
                    <button type="button" data-bind="click: function(){appStateModel.customFilters.filterByTime(false)},
                            attr: {class: ('btn btn-default' + (!appStateModel.customFilters.filterByTime() ? ' active' : ''))}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Set Zoom to normal operation">Normal
                    </button>
                </div>
                <button type="button" data-bind="click: function(){appStateModel.reloadCaches()}"
                                      class="btn btn-default"
                                      data-toggle="tooltip"
                                      data-placement="top"
                                      title="Reload Server Side Caches">Reload Server Cache
                </button>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 text-left">
                <!-- Search Box -->
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search"
                           data-bind="value: appStateModel.textFilter, valueUpdate: 'afterkeydown'">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button">
                            <span class="glyphicon glyphicon-search"></span>
                        </button>
                        <button class="btn btn-default" type="button"
                                                        data-bind="click: appStateModel.clearSearch"
                                                        data-toggle="tooltip"
                                                        data-placement="top"
                                                        title="Clear the search bar.">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                        <button class="btn btn-default dropdown-toggle" type="button"
                                data-bind="click: appStateModel.customFilters.fetchAllFilters"
                                data-toggle="dropdown"
                                data-toggle="tooltip"
                                data-placement="top"
                                title="View filtering options.">
                            Filters
                            <span class="badge" data-bind="text: appStateModel.customFilters.allMatchedItems().length,
                                                           visible: appStateModel.customFilters.allMatchedItems().length > 0">
                            </span>
                            <span class="caret"></span>
                        </button>
                        <button class="btn btn-default" type="button"
                                data-bind="click: appStateModel.customFilters.toggleMatchIntersection,
                                text: appStateModel.customFilters.matchIntersection() ? 'Match Union' : 'Match Intersection',
                                visible: appStateModel.customFilters.matchTypeVisible">
                        </button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <!-- ko foreach: appStateModel.customFilters.defaultFilters -->
                                <li role="presentation">
                                    <a data-bind="click: openFilter, text: filterName"
                                       data-toggle="tooltip"
                                       data-placement="top"
                                       title="Open the default filter."
                                       style="cursor: pointer">
                                    </a>
                                </li>
                            <!-- /ko -->
                            <li role="presentation" class="divider"></li>
                            <!-- ko foreach: appStateModel.customFilters.remoteCustomFilters -->
                                <li role="presentation">
                                    <a data-bind="click: openFilter, text: filterName"
                                       data-toggle="tooltip"
                                       data-placement="top"
                                       title="Open the remote custom filter."
                                       style="cursor: pointer">
                                    </a>
                                </li>
                            <!-- /ko -->
                            <li role="presentation" class="divider"></li>
                            <li role="presentation">
                                <a data-bind="click: appStateModel.customFilters.addCustomFilter"
                                   data-toggle="tooltip"
                                   data-placement="top"
                                   title="Create a custom filter."
                                   style="cursor: pointer">New Custom Filter</a>

                            </li>
                            <li role="presentation">
                                <a data-bind="click: appStateModel.customFilters.clearAllFilters"
                                   data-toggle="tooltip"
                                   data-placement="top"
                                   title="Clear all filters."
                                   style="cursor: pointer">Clear All</a>
                            </li>
                        </ul>
                    </span>
                </div>
            </div>

            <!-- Group Control Menu -->
            <div class="col-md-6 text-right">
                <div class="btn-group" data-bind="visible: login.elements.authenticated">
                    <button type="button" class="btn btn-default"
                                          data-bind="click: function(){appStateModel.controlAgent({'com':'stop', 'stay_down':true, 'clear_group':true})}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Stop the starred services.">
                        <span class="glyphicon glyphicon-stop"></span></button>
                    <button type="button" class="btn btn-default"
                                          data-bind="click: function(){appStateModel.controlAgent({'com':'restart', 'stay_down':false, 'clear_group':true})}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Restart the starred services.">
                        <span class="glyphicon glyphicon-retweet"></span></button>
                    <button type="button" class="btn btn-default"
                                          data-bind="click: function(){appStateModel.controlAgent({'com':'ignore', 'clear_group':true})}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Command the starred agents to ignore Zookeeper changes.">Ignore</button>
                    <button type="button" class="btn btn-default"
                                          data-bind="click: function(){appStateModel.controlAgent({'com':'react', 'clear_group':true})}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Command the starred agents to react to Zookeeper changes.">React</button>
                    <button type="button" class="btn btn-default"
                                          data-bind="click: function(){appStateModel.controlAgent({'com':'cancel','clear_group':true})}"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Cancel pending commands for the starred agents.">Cancel</button>
                    <button type="button" class="btn btn-default"
                                          data-bind="click: appStateModel.filteredGroupControl"
                                          data-toggle="tooltip"
                                          data-placement="top"
                                          title="Star all of the filtered agents.">
                        <span class="glyphicon glyphicon-star"></span> all</button>
                    <button class="btn btn-default" data-bind="click: appStateModel.clearGroupControl"
                                                    data-toggle="tooltip"
                                                    data-placement="top"
                                                    title="Release all starred agents.">
                        <span class="badge" data-bind="text: appStateModel.groupControl().length"></span>
                        <span class="glyphicon glyphicon-remove"></span>
                    </button>
                </div>
            </div>
            <!-- END Group Control Menu -->
        </div>

        <div class="row">
            <!-- Custom Filters -->
            <div class="col-md-12">
                <div data-bind="foreach: appStateModel.customFilters.all">
                    <div class="row app-row">
                        <div class="col-md-12">
                            <div class="btn-group">
                                <button class="btn btn-default" data-bind="click: deleteFilter"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Close the filter.">
                                    <span class="glyphicon glyphicon-remove"></span>
                                    <span class="badge" data-bind="text: $data.matchedItems().length, visible: enabled() "></span>
                                </button>
                                <button class="btn btn-default"
                                        data-bind="click: toggleEnabled, visible: !enabled()"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Enable the filter.">
                                    <span class="glyphicon glyphicon-off"></span>
                                </button>
                                <button class="btn btn-default active"
                                        type="button"
                                        data-bind="click: toggleEnabled, visible: enabled()"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Disable the filter.">
                                    <span class="glyphicon glyphicon-off"></span>
                                </button>
                                <button class="btn btn-default"
                                        type="button"
                                        data-bind="click: toggleInversed, visible: !inversed()"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Inverse the filter.">
                                    Inverse
                                </button>
                                <button class="btn btn-default active"
                                        data-bind="click: toggleInversed, visible: inversed()"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Un-inverse the filter.">
                                    Inverse
                                </button>
                            </div>
                            <div class="btn-group">
                                <button data-bind="click: function(){setParameter('applicationStatus')},
                                        attr: {class : ('btn btn-default' + ((parameter() == 'applicationStatus') ? ' active' : ''))}"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Filter by Up/Down status.">
                                    Up/Down
                                </button>
                                <button data-bind="click: function(){setParameter('configurationPath')}, 
                                        attr: {class : ('btn btn-default' + ((parameter() == 'configurationPath') ? ' active' : ''))}"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Filter by configuration path.">
                                    Path
                                </button>
                                <button data-bind="click: function(){setParameter('applicationHost')},
                                        attr: {class : ('btn btn-default' + ((parameter() == 'applicationHost') ? ' active' : ''))}"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Filter by host.">
                                    Host
                                </button>
                                <button data-bind="click: function(){setParameter('errorState')},
                                        attr: {class : ('btn btn-default' + ((parameter() == 'errorState') ? ' active' : ''))}"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Filter by error state.">
                                    Status
                                </button>
                                <button data-bind="click: function(){setParameter('dependency')},
                                        attr: {class : ('btn btn-default' + ((parameter() == 'dependency' || 
                                                       parameter() == 'upstream' ||
                                                       parameter() == 'downstream') ? ' active' : ''))}"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Filter by dependent on.">
                                    Dependency
                                </button>
                            </div>
                            <span data-bind="template: {name: 'search-term-template'}"></span>
                            <span data-bind="template: {name : 'remote-filter-alteration-template'}, 
                                             visible: canBeAlteredRemotely && $parent.login.elements.authenticated">
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- END Custom Filters -->
        </div>
    </div>

    <div class="page-body">
        <table class="table table-bordered table-condensed" >
            <!-- Headers -->
            <thead>
                <tr data-bind="foreach: appStateModel.headers">
                    <th
                        data-toggle="tooltip"
                        data-placement="top"
                        data-bind="visible: $parent.appStateModel.showHeader($index())">
                        <span data-bind="visible: $parent.appStateModel.activeSort().title == title">
                            <span class="caret-reversed" data-bind="visible: asc"></span>
                            <span class="caret" data-bind="visible: !asc()"></span>
                        </span>
                        <span data-bind="text: title, click: $parent.appStateModel.sort" class= "cursor-pointer"
                            title="Toggle ascending/descending sort based on this column."></span>
                        <span data-bind="visible: title == 'Application ID'" class="cursor-pointer"
                            title="Toggle the display of all dependencies.">
                            <small data-bind="click: $parent.appStateModel.expandAllDependencies,
                                              visible: !$parent.appStateModel.showingAllDependencies()"
                                   data-toggle="tooltip"
                                   data-placement="top">
                                (Expand All)
                            </small>
                            <small data-bind="click: $parent.appStateModel.collapseAllDependencies,
                                              visible: $parent.appStateModel.showingAllDependencies()"
                                   data-toggle="tooltip"
                                   data-placement="top">
                                Collapse All
                            </small>
                        </span>
                    </th>
                </tr>
            </thead>
            <!-- END Headers -->
            <!-- Rows -->
            <tbody data-bind="foreach: appStateModel.appsToShow">
                <tr>
                    <td data-bind="style : {backgroundColor : applicationStatusBg}" class="text-center">
                        <span data-bind="attr : {class : applicationStatusClass}"></span>
                    </td>
                    <td data-toggle="tooltip"
                        data-placement="top">
                        <span title="Toggle the display of dependencies." class="cursor-pointer" 
                            data-bind="text: componentId, click: dependencyModel.toggleDependencies,
                            style: {cursor: dependencyModel.dependencyPointer}">
                        </span>
                        <span data-bind="attr : {class : dependencyModel.dependencyClass}"></span>
                        <span title="Toggle the display of notes." 
                            class="glyphicon glyphicon-info-sign pull-right cursor-pointer" 
                            data-bind="click: appInfo.toggle">
                        </span>
                        <div data-bind="visible: dependencyModel.dependencyVisible">
                            <span data-bind="visible: dependencyModel.upstream().length > 0">I require:</span>
                            <ul class="dep-list"
                                 data-bind="foreach: dependencyModel.upstream, visible: dependencyModel.upstream().length > 0">
                                <span data-bind="template: {name : 'dependencies-template'}"></span>
                            </ul>
                            <span data-bind="visible: dependencyModel.timeComponent">Time:</span>
                            <ul class="dep-list"
                                data-bind="foreach: dependencyModel.time">
                                <li data-bind="text: $data"></li>
                            </ul>

                            <span data-bind="visible: dependencyModel.downstream().length > 0">I am required by:</span>
                            <ul class="dep-list"
                                data-bind="foreach: dependencyModel.downstream">
                                <li data-bind="text: $data"></li>
                            </ul>

                        </div>
                        <div class="alert alert-info" role="alert" 
                             data-bind="visible: (appInfo.showInfo() && $parent.login.elements.authenticated()), text: appInfo.data,
                                        event : {mouseout: function(){appInfo.save();}},
                                        attr : {name: configurationPath}"
                             contenteditable="true">
                        </div>
                        <div class="alert alert-info" role="alert"
                             data-bind="visible: (appInfo.showInfo() && !$parent.login.elements.authenticated()), text: appInfo.data">
                        </div>
                    </td>
                    <td class="text-left">
                        <div class="dropdown server-opt"> 
                            <div class="dropdown-toggle"
                                tabindex="-1"
                                href="#"
                                title="View sentinel config and metrics for this host."
                                data-toggle="dropdown" >
                                <span data-bind="text: applicationHostShort" class="cursor-pointer"/>
                            </div>
                            <ul class="dropdown-menu" role=menu >
                                <li role="presentation">
                                    <a role="menuitem" style="cursor:pointer" tabindex="-1" href='#'
                                        data-bind="click: function(){$parent.appStateModel.showSentinelConfig(applicationHost)}">Go to Sentinel Config</a></li>
                                    
                                <li role="presentation" class="divider"></li>    
                                <li role="presentation">
                                    <a role="menuitem" style="cursor:pointer" tabindex="-1" href="#"
                                       data-bind="click: function(){graphite.modalShow([graphite.startupMetricsURL,
                                                                                        graphite.upDownURL,
                                                                                        graphite.cpuURL,
                                                                                        graphite.networkURL,
                                                                                        graphite.memoryURL,
                                                                                        graphite.diskSpaceURL,
                                                                                        graphite.bufferErrorsURL])}">
                                        All Metrics
                                    </a>
                                </li>
                                <li role="presentation" class="divider"></li>
                                <li role="presentation"><a role="menuitem" style="cursor:pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.startupMetricsURL])}">Application Startup</a></li>
                                <li role="presentation"><a role="menuitem" style="cursor:pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.upDownURL])}">Applicaiton Uptime</a></li>
                                <li role="presentation" class="divider"></li>
                                <li role="presentation"><a role="menuitem" style="cursor:pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.cpuURL])}">CPU Graph</a></li>
                                <li role="presentation"><a role="menuitem" style="cursor: pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.memoryURL])}">Memory Graph</a></li>
                                <li role="presentation"><a role="menuitem" style="cursor: pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.networkURL])}">Network Graph</a></li>
                                <li role="presentation"><a role="menuitem" style="cursor: pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.diskSpaceURL])}">Disk Graph</a></li>
                                <li role="presentation"><a role="menuitem" style="cursor: pointer" tabindex="-1" href="#"
                                                           data-bind="click: function(){graphite.modalShow([graphite.bufferErrorsURL])}">Buffer Errors</a></li>
                            </ul>
                        </div>
                    <td class="text-left">
                        <span data-bind="text: startStopTime, attr: {title : startStopTimeTitle}"></span>
                    </td>
                    <td data-bind="text: lastUpdate"></td>
                    <td class="text-center" data-bind="style : {backgroundColor : errorStateBg}" >
                        <span data-bind="attr : {class : errorStateClass, title : errorStateTitle}"></span>
                        <span data-bind="attr : {class : modeClass, title : mode}"></span>
                        <span data-bind="attr : {class : readOnlyClass}"  title="Read Only"></span>
                        <span data-bind="attr : {class : pdDisabledClass, title: pdDisabled() ? 'PD alerts disabled' : ''}"></span>
                    </td>
                    <!-- Control -->
                    <td class="text-center" data-bind="visible: $parent.login.elements.authenticated">
                        <div class="btn-group btn-group-xs" >
                            <button class="btn btn-default" type="button"
                                    data-bind="click: toggleGroupControl"
                                    data-toggle="tooltip" data-placement="top" title="Star the agent to add it to group control.">
                                    <span data-bind="attr : {class : groupControlStar}"></span>
                            </button>
                            <button class="btn btn-default dropdown-toggle" type="button"
                                    data-toggle="dropdown" data-toggle="tooltip" data-placement="top"
                                    title="View control options for the agent.">
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu pull-right" role="menu">
                                <li role="presentation">
                                <a style="cursor: pointer" data-bind="click: function()
                                    {$parent.appStateModel.controlAgent({'com':'stop', 'stay_down':true}, {'componentId':componentId,
                                    'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Stop the service.">Stop</a>
                                </li>
                                <li role="presentation">
                                <a style="cursor: pointer" data-bind="click: function()
                                    {$parent.appStateModel.controlAgent({'com':'restart', 'stay_down':false}, {'componentId':componentId,
                                    'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Restart the service.">Restart</a>
                                </li>
                                <li style="cursor: pointer" role="presentation">
                                    <a data-bind="click: function()
                                     {$parent.appStateModel.controlAgent({'com':'cancel'}, {'componentId':componentId,
                                     'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Cancel running command.">Cancel</a>
                                </li>
                                <li style="cursor: pointer" role="presentation">
                                    <a data-bind="click: function()
                                      {$parent.appStateModel.controlAgent({'com':'ignore'}, {'componentId':componentId,
                                      'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Command the agent to ignore Zookeeper changes.">Ignore</a>
                                </li>
                                <li style="cursor: pointer" role="presentation">
                                    <a data-bind="click: function()
                                     {$parent.appStateModel.controlAgent({'com':'react'}, {'componentId':componentId,
                                     'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Command the agent to react to Zookeeper changes.">React</a>
                                </li>
                                <li style="cursor: pointer" role="presentation">
                                    <a data-bind="click: function()
                                     {$parent.appStateModel.displayOpdep({'componentId':componentId,
                                     'configurationPath': configurationPath, 'applicationHost': applicationHost()})}"
                                       data-toggle="tooltip" data-placement="top" title="Show Downstream Operational Dependencies for this service">Downstream Opdep</a>
                                </li>
                           </ul>
                        </div>
                    </td>
                    <!-- END Control -->
                    <!-- Admin -->
                    <td class="text-center" data-bind="visible: $parent.appStateModel.admin.enabled">
                        <div class="btn-group btn-group-xs" >
                            <button class="btn btn-default dropdown-toggle" type="button"
                                    data-toggle="dropdown"
                                    data-toggle="tooltip" data-placement="top" title="Admin options for the agent.">
                                Admin Options
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu pull-right" role="menu">
                                <li role="presentation">
                                <a style="cursor: pointer" data-bind="click: deleteRow"
                                   data-toggle="tooltip" data-placement="top" title="Permanently delete this application">Delete</a>
                                </li>
                                <li role="presentation">
                                <a style="cursor: pointer" data-bind="click: toggleGrayed, text: grayed() ? 'Un-Gray' : 'Gray-Out'"
                                   data-toggle="tooltip" data-placement="top" title="Whether to Gray out the app."></a>
                                </li>
                                <li role="presentation">
                                <a style="cursor: pointer" data-bind="click: togglePDDisabled, text: pdDisabled() ? 'PD-Enable' : 'PD-Disable'"
                                   data-toggle="tooltip" data-placement="top" title="Whether to disable PD alerts."></a>
                                </li>
                           </ul>
                        </div>
                    </td>
                    <!-- END Admin -->
                </tr>
            </tbody>
            <!-- END Rows -->
        </table>
        <div data-bind="visible: appStateModel.filteredItems().length == appStateModel.appsToShow().length ">
            <p class="text-center"> No more services to show </p>
        </div>

        <div class="page-body scroll-footer" data-bind="visible: appStateModel.filteredItems().length != appStateModel.appsToShow().length ">
                Scroll down to load more 
        </div>
    </div>
    <div class="splash">
        <i class="fa fa-spinner fa-spin" data-bind="visible: appStateModel.applicationStateArray().length == 0"></i>
    </div>
</div>

<!-- Templates for Custom Filters -->
<script type="text/html" id="search-term-template">
    <!-- ko if: parameter() == "applicationStatus" -->
    <span data-bind="template: {name:'status-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "errorState" -->
    <span data-bind="template: {name:'error-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "applicationHost" -->
    <span data-bind="template: {name:'path-host-time-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "startStopTime" -->
    <span data-bind="template: {name:'path-host-time-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "lastUpdate" -->
    <span data-bind="template: {name:'path-host-time-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "configurationPath"-->
    <span data-bind="template: {name:'path-host-time-filter-template'}"></span>
    <!-- /ko -->

    <!-- ko if: parameter() == "dependency" || parameter() == "upstream" || parameter() == "downstream"-->
    <span data-bind="template: {name:'dependency-filter-template'}"></span>
    <!-- /ko -->
</script>

<script type="text/html" id="status-filter-template">
    <div class="btn-group" data-toggle="buttons">
        <button data-bind="click: function(){setSearchTerm('running')},
                           attr: {class : ('btn btn-default' + ((searchTerm() == 'running') ? ' active' : ''))}"
                data-toggle="tooltip"
                data-placement="top"
                title="Filter running services.">
            <input type="radio">
            <span class="glyphicon glyphicon-ok-circle"></span>
            </input>
        </button>
        <button data-bind="click: function(){setSearchTerm('stopped')},
                           attr: {class : ('btn btn-default' + ((searchTerm() == 'stopped') ? ' active' : ''))}"
                data-toggle="tooltip"
                data-placement="top"
                title="Filter stopped services.">
            <input type="radio">
            <span class="glyphicon glyphicon-remove-circle"></span>
            </input>
        </button>
        <button data-bind="click: function(){setSearchTerm('unknown')},
                           attr: {class : ('btn btn-default' + ((searchTerm() == 'unknown') ? ' active' : ''))}"
                data-toggle="tooltip"
                data-placement="top"
                title="Filter services whose up/down status is unknown.">
            <input type="radio">
            <span class="glyphicon glyphicon-question-sign"></span>
            </input>
        </button>
    </div>
</script>

<script type="text/html" id="error-filter-template">
    <div class="btn-group" data-bind="foreach: filterButtons">
        <button data-bind="click: function(){$parent.setSearchTerm(term)},
                           attr: {class : ('btn btn-default' + (($parent.searchTerm() == term) ? ' active' : '')), title: title}"
                data-toggle="tooltip" data-placement="top">
            <span data-bind="attr: {class: glyph}" ></span>
        </button>
    </div>
</script>

<script type="text/html" id="path-host-time-filter-template">
    <span class="form-inline">
        <input type="text" data-bind="value: searchTerm, valueUpdate: 'keyup'" class="form-control">
    </span>
</script>

<script type="text/html" id="dependency-filter-template">
    <div class="btn-group">
        <button data-bind="click: function(){setParameter('upstream')},
                           attr: {class : ('btn btn-default' + ((parameter() == 'upstream') ? ' active' : ''))}"
                data-toggle="tooltip"
                data-placement="top"
                title="Filter by services that require the search term.">
            Requires
        </button>
        <button data-bind="click: function(){setParameter('downstream')},
                           attr: {class : ('btn btn-default' + ((parameter() == 'downstream') ? ' active' : ''))}"
                data-toggle="tooltip"
                data-placement="top"
                title="Filter by services required by the search term.">
            Required By
        </button>
    </div>
    <span class="form-inline">
        <input type="text" data-bind="value: searchTerm, valueUpdate: 'keyup'" class="form-control">
    </span>
</script>

<script type="text/html" id="remote-filter-alteration-template">
    <div class="btn-group">
        <button class="btn btn-default" data-bind="click: saveFilterRemotely"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Save/Update the filter on a remote database.">
            <span class="glyphicon glyphicon-floppy-disk"></span>
        </button>
        <button class="btn btn-default" data-bind="click: deleteFilterRemotely"
                                        data-toggle="tooltip"
                                        data-placement="top"
                                        title="Delete the filter from the remote database.">
            <span class="glyphicon glyphicon-floppy-remove"></span>
        </button>
    </div>
    <span class="form-inline">
        <input type="text" data-bind="value: filterName, valueUpdate: 'keyup'" class="form-control filter-name" 
        placeholder="Filter Name...">
    </span>
</script>
<!-- END Templates for Custom Filters -->

<!-- Template for Displaying Dependencies -->
<script type="text/html" id="dependencies-template">
    <li data-bind="style : {backgroundColor : $data.state.applicationStatusBg}" >
        <span data-bind="attr : {class : $data.state.applicationStatusClass}" style="padding: 4px"></span>
        <span class="cursor-pointer" data-bind="text: $data.state.componentId + ($data.operational ? ' (Operational)' : '')"></span>
    </li>
</script>

<script>
  $(function () { $("[data-toggle='tooltip']").tooltip(); });
</script>
</section>
